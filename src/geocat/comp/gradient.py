from typing import Union

import numpy as np
import xarray as xr

SupportedTypes = Union[np.ndarray, xr.DataArray]


def radwgs84(lat):
    return 0.00000000000005543252439466138 * lat**32 + 0.000000000002395793788338843 * lat**30 - 0.00000000005229857263512986 * lat**28 + 0.0000000004220369673646614 * lat**26 + 0.000000003422923341532417 * lat**24 - 0.0000001500527248474233 * lat**22 + 0.000001947430322210538 * lat**20 - 0.000001615020299728849 * lat**18 - 0.0004308176599710854 * lat**16 + 0.008618488632471015 * lat**14 - 0.04921793395294104 * lat**12 - 1.781827805862227 * lat**10 + 60.74731491770759 * lat**8 - 925.1372269031793 * lat**6 + 7080.549478864607 * lat**4 - 21348.83635376933 * lat**2 + 6378137.0


def _arcwgs84(lat):
    return 0.00000000000000167977346650489 * lat**33 + 0.00000000000007728367059157557 * lat**31 - 0.000000000001803399056383788 * lat**29 + 0.00000000001563099879128375 * lat**27 + 0.0000000001369169336612967 * lat**25 - 0.000000006524031515105361 * lat**23 + 0.00000009273477724812085 * lat**21 - 0.00000008500106840678155 * lat**19 - 0.00002534221529241679 * lat**17 + 0.0005745659088314009 * lat**15 - 0.003785994919457003 * lat**13 - 0.1619843459874752 * lat**11 + 6.749701657523066 * lat**9 - 132.1624609861685 * lat**7 + 1416.109895772921 * lat**5 - 7116.278784589776 * lat**3 + 6378137.0 * lat


def arcwgs84(lat1, lat2):
    return abs(_arcwgs84(lat1) - _arcwgs84(lat2))
