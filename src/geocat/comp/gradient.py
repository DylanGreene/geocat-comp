from typing import Union

import numpy as np
import xarray as xr

SupportedTypes = Union[np.ndarray, xr.DataArray]


def rad_wgs84(lat):
    return \
        3.046775254824756e-70 * lat ** 32 + \
        4.322852948553110e-65 * lat ** 30 - \
        3.097819637843901e-60 * lat ** 28 + \
        8.206577043612313e-56 * lat ** 26 + \
        2.185012848730189e-51 * lat ** 24 - \
        3.144459267034150e-46 * lat ** 22 + \
        1.339705312896690e-41 * lat ** 20 - \
        3.647292571651390e-38 * lat ** 18 - \
        3.193974017793312e-32 * lat ** 16 + \
        2.097559357089568e-27 * lat ** 14 - \
        3.932346603086970e-23 * lat ** 12 - \
        4.673469447172801e-18 * lat ** 10 + \
        5.230533973007157e-13 * lat ** 8 - \
        2.614991987936281e-08 * lat ** 6 + \
        6.570167359753477e-04 * lat ** 4 - \
        6.503227445533897e+00 * lat ** 2 + \
        6378137.0


def _arc_wgs84(lat):
    return \
        1.611401811060038e-73 * lat ** 33 + \
        2.433807001025704e-68 * lat ** 31 - \
        1.864384562528083e-63 * lat ** 29 + \
        5.304881101096931e-59 * lat ** 27 + \
        1.525426736348904e-54 * lat ** 25 - \
        2.386137713243196e-49 * lat ** 23 + \
        1.113441367452766e-44 * lat ** 21 - \
        3.350382324149892e-41 * lat ** 19 - \
        3.279138990214426e-35 * lat ** 17 + \
        2.440621135815228e-30 * lat ** 15 - \
        5.279415042575557e-26 * lat ** 13 - \
        7.415220849502234e-21 * lat ** 11 + \
        1.014333771848834e-15 * lat ** 9 - \
        6.520031443251421e-11 * lat ** 7 + \
        2.293421056695219e-06 * lat ** 5 - \
        3.783424364354224e-02 * lat ** 3 + \
        111319.4907932736 * lat


def arc_wgs84(lat1, lat2):
    return abs(_arcwgs84(lat1) - _arcwgs84(lat2))
